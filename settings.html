<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>flashback – settings</title>
    <link rel="stylesheet" href="map.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Just+Me+Again+Down+Here&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <main class="main-flex">
      <aside class="sidebar scrapbook-border">
        <a
          href="index.html"
          class="flashback-cute"
          style="text-decoration: none; color: #f89090"
          >flashback</a
        >
        <nav class="sidebar-menu" style="margin-top: 1.5em">
          <button
            type="button"
            class="sidebar-menu-item"
            onclick="window.location.href='map.html'"
          >
            Map
          </button>
          <button
            type="button"
            class="sidebar-menu-item"
            onclick="window.location.href='drop-pin.html'"
          >
            Drop a Pin
          </button>
          <button
            type="button"
            class="sidebar-menu-item"
            onclick="window.location.href='profile.html'"
          >
            Profile
          </button>
          <button type="button" class="sidebar-menu-item active">
            Settings
          </button>
        </nav>
        <div style="flex: 1"></div>
        <div
          id="sidebar-user-profile"
          style="
            display: flex;
            align-items: center;
            gap: 0.8em;
            padding: 1.2em 1.2em 2.5em 1.2em;
            margin-bottom: 1.5em;
          "
        >
          <img
            id="sidebar-user-avatar"
            src="https://api.dicebear.com/7.x/personas/svg?seed=ava"
            alt="User Avatar"
            style="
              width: 44px;
              height: 44px;
              border-radius: 50%;
              border: 2.5px solid #f89090;
              background: #fff;
              object-fit: cover;
            "
          />
          <span
            id="sidebar-user-name"
            style="
              font-family: 'Just Me Again Down Here', cursive;
              font-size: 1.3em;
              color: #f89090;
              font-weight: bold;
            "
            >User</span
          >
        </div>
      </aside>
      <section class="profile-green-full">
        <div
          style="
            margin: 2.5em 0 0 2.5em;
            display: flex;
            flex-direction: column;
            gap: 1.5em;
            align-items: flex-start;
            max-height: 90vh;
            overflow-y: auto;
            min-width: 340px;
            width: 100%;
          "
        >
          <h2
            style="
              font-family: 'Just Me Again Down Here', cursive;
              font-size: 2.2em;
              color: #f89090;
              margin: 0 0 0.7em 0;
              font-weight: normal;
              letter-spacing: 1px;
              text-align: left;
            "
          >
            Update Profile
          </h2>
          <div
            style="
              display: flex;
              align-items: center;
              gap: 1.2em;
              margin-bottom: 1.2em;
            "
          >
            <div style="position: relative">
              <img
                id="profile-avatar"
                src="https://api.dicebear.com/7.x/personas/svg?seed=ava"
                alt="Profile Picture"
                style="
                  width: 74px;
                  height: 74px;
                  border-radius: 50%;
                  border: 3px solid #4caf50;
                  background: #fff;
                  object-fit: cover;
                "
              />
              <label
                for="profile-photo-upload"
                style="
                  position: absolute;
                  bottom: 0;
                  right: 0;
                  background: #066920;
                  color: #fff;
                  border-radius: 50%;
                  width: 28px;
                  height: 28px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  cursor: pointer;
                  border: 2px solid #fff;
                  font-size: 1.2em;
                "
              >
                <span style="font-size: 1.2em">+</span>
                <input
                  id="profile-photo-upload"
                  type="file"
                  accept="image/*"
                  style="display: none"
                />
              </label>
            </div>
          </div>
          <div
            style="
              display: flex;
              flex-direction: column;
              gap: 1em;
              width: 100%;
              max-width: 420px;
            "
          >
            <label style="font-size: 1.1em; color: #7a5c2e; text-align: left"
              >Name
              <input
                type="text"
                id="profile-name"
                placeholder="Your name"
                style="
                  width: 100%;
                  padding: 0.7em;
                  border-radius: 8px;
                  border: 2px solid #f89090;
                  background: #fde8e8;
                  font-size: 1em;
                  margin-top: 0.3em;
                  text-align: left;
                  font-family: 'Just Me Again Down Here', cursive;
                  color: #7a5c2e;
                "
              />
            </label>
            <label style="font-size: 1.1em; color: #7a5c2e; text-align: left"
              >Username
              <input
                type="text"
                id="profile-username"
                placeholder="Username"
                style="
                  width: 100%;
                  padding: 0.7em;
                  border-radius: 8px;
                  border: 2px solid #f89090;
                  background: #fde8e8;
                  font-size: 1em;
                  margin-top: 0.3em;
                  text-align: left;
                  font-family: 'Just Me Again Down Here', cursive;
                  color: #7a5c2e;
                "
              />
            </label>
            <label style="font-size: 1.1em; color: #7a5c2e; text-align: left"
              >About you
              <textarea
                id="profile-about"
                placeholder="About you"
                rows="2"
                style="
                  width: 100%;
                  padding: 0.7em;
                  border-radius: 8px;
                  border: 2px solid #f89090;
                  background: #fde8e8;
                  font-size: 1em;
                  margin-top: 0.3em;
                  resize: vertical;
                  text-align: left;
                  font-family: 'Just Me Again Down Here', cursive;
                  color: #7a5c2e;
                "
              ></textarea>
            </label>
            <label style="font-size: 1.1em; color: #7a5c2e; text-align: left"
              >Location
              <input
                type="text"
                id="profile-location"
                placeholder="Location"
                style="
                  width: 100%;
                  padding: 0.7em;
                  border-radius: 8px;
                  border: 2px solid #f89090;
                  background: #fde8e8;
                  font-size: 1em;
                  margin-top: 0.3em;
                  text-align: left;
                  font-family: 'Just Me Again Down Here', cursive;
                  color: #7a5c2e;
                "
              />
            </label>
          </div>
          <button
            type="button"
            style="
              background: #f89090;
              color: #fff;
              border: none;
              border-radius: 10px;
              padding: 0.9em 2.5em;
              font-size: 1.1em;
              font-family: 'Just Me Again Down Here', cursive;
              font-weight: bold;
              cursor: pointer;
              margin-top: 1.2em;
              margin-bottom: 2.5em;
              align-self: flex-start;
              box-shadow: none;
            "
          >
            Save
          </button>
        </div>
      </section>
    </main>
    <footer>
      <a href="index.html">← Back to home</a>
    </footer>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script>
      window.addEventListener('DOMContentLoaded', function () {
        function setUserSidebar(user) {
          const nameSpan = document.getElementById('sidebar-user-name');
          const avatarImg = document.getElementById('sidebar-user-avatar');
          if (user) {
            nameSpan.textContent = user.displayName || user.email || 'User';
            if (user.photoURL) {
              avatarImg.src = user.photoURL;
            } else {
              const seed = encodeURIComponent(
                user.displayName || user.email || 'ava'
              );
              avatarImg.src = `https://api.dicebear.com/7.x/personas/svg?seed=${seed}`;
            }
          } else {
            nameSpan.textContent = 'User';
            avatarImg.src =
              'https://api.dicebear.com/7.x/personas/svg?seed=ava';
          }
        }
        function checkAuth() {
          if (window.firebase && firebase.auth) {
            firebase.auth().onAuthStateChanged(function (user) {
              setUserSidebar(user);
            });
          } else {
            setTimeout(checkAuth, 100);
          }
        }
        checkAuth();
      });
    </script>
  </body>
</html>
